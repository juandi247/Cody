This is Cody a mini version of nginx (or at least what i want to do)


current state - whats next - what should i do - etcetcetc



Nginx is a master - worker aproach
Its a server web that uses epoll as a way to avoid blocking i/o
Making it from scratch means that i need the following things:


master-worker aproach
                have one master socket that redirects

Socket creation
                binding to a port
                make it listen
                accepting loop
                reading from the socket


Http parsing 
                read the bytes of the socket
                "tokenize them in a way"
                parse them, see that its a correct http_request



Following things    
                respond with an http_response
                use "caching layer"
                socket keep-alive connection
                (try using hash functions to caching 304 not changed or something)


Compresion things
                gzip, compress htmls or js files


Security
                Not allowing to go on root
                DDos (some type of rate limiting)









First steps: 

1.  Master - worker socket aproach
    Create the master socket 
    create the strcuture and all for workers and master blablalb
    make the fork
    define finite number (can be passed as arg, or something but no need)

    try everything.






2. Read and parse an http http_request

it should have 
    Method
    Path 
    Headers
    body
    keepAlive?




Steps:
    - Read until we reach the first \r \n 
    READ_FIRST

    -REad until we reach a double \r\n \r\n 
    READ_HEADERS //todo: we need a way to know how to PARSE the headers, and interpret them later

    -Read the body (if the header content length exists, we continue reading until we read all the bytes)




    -Construct the http_request_t




    


STATES:
READ_FIRST



READ_HEADERS 

READ_BODY


READ_END
    




GET /index.html HTTP/1.1 \r\n
Host: www.ejemplo.com \r\n
User-Agent: Chrome/5.0 \r\n
Accept: text/html \r\n
 \r\n
 \r\n



STATE READ_FIRST

GET /inde   -> BUFFER[GET /inde]

x.html  -> BUFFER[GET /index.html ]

HTTP/1.1  -> BUFFER[GET /index.html HTTP 1.1 \r\n]


CHANGE STATE








